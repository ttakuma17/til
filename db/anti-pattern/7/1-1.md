課題1-1
## 1. 前提
- テーブル設計において、「どのようにテーブルを分けるか」「どのカラムにどの情報を格納するか」を考える。

## 2. アンチパターンの名前
**削除フラグ**  
データを物理削除せずに論理削除を行うためのフラグをテーブルに持たせる設計。

## 3. アンチパターンによる問題
- **クエリの複雑化**  
  - ユーザー関連の情報を取得する際に `taikaiFlag`（退会フラグ）を利用すると、常にSQLの条件に含める必要がある。
  - 退会・復会を繰り返した場合に過去の履歴を追跡できない。
  - 削除フラグのあるテーブルを `JOIN` する場合、`WHERE` 句で除外する必要がある。
  - 削除済みのデータが誤って取得される可能性があり、誤った案内メール送信などの事故につながる。

- **データの整合性が担保できない**  
  - 削除フラグを `ON` にした後、同じ主キー（PK）のデータが `INSERT` される可能性がある。
  - `UNIQUE` 制約を適用しづらくなる。

- **削除フラグの管理ミス**  
  - フラグの立て忘れにより、データが「生きている」のか「削除済み」なのか判別できなくなる。
  - データが永続的に残り、不要なデータが蓄積する。

- **誤った認識を生む**  
  - 削除フラグがあることで「このデータは削除しても良い」という誤った認識を与える可能性がある。

- **アプリケーション側の負担増**  
  - クエリの複雑化、データの整合性の問題、削除フラグの管理ミスを防ぐために、アプリケーション側で考慮すべきことが増える。

## 4. アンチパターンを使うことを許容する条件
- **論理削除がパフォーマンス要件を満たす場合**  
  - データの物理削除がシステムのパフォーマンスに悪影響を与える場合。
  - 削除フラグを利用することが、唯一の選択肢である場合。

## 5. 参考
- https://speakerdeck.com/soudai/delete-flag
- https://qiita.com/o-y/items/e46079dd8f93c75ca2b6
- https://qiita.com/abcaaa/items/d82e5507814d3f914524
- https://www.slideshare.net/slideshow/ronsakucasual/52256922
- https://ledsun.hatenablog.com/entry/2015/03/27/015203
- https://mike-neck.hatenadiary.com/entry/2015/03/24/231422
- https://zenn.dev/marimoofficial/articles/e8d6cc89d05d3e
- https://soudai.hatenablog.com/entry/2018/05/01/204442
