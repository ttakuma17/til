### 課題1

以下の用語を解説する(調べるなかで関連ででてきたものも追加してます)

- エンティティ
  - 個別に認識できる実体で管理番号を持つオブジェクトのこと
  - 性質
    - 可変である(必要に応じて可変にしていいということ。可変を推奨するわけではない)
    - 同じ属性であっても区別される
    - 同一性をもつ

- 値オブジェクト（バリューオブジェクト）
  - 業務ルールに基づく計算判断に使う値を扱うオブジェクトのこと
  - システムの固有の値を表現するオブジェクトのこと
  - 性質
    - 不変である
    - 交換可能
    - 等価性によって比較される
  - システムの扱う値をすべてを値オブジェクトとして表現はできるが、しなくてもいいこともある
    - しない場合の基準として、「ルールが存在するか」と「それ単体で扱いたいか」というものがある

- エンティティと値オブジェクトの区別
  - ライフサイクルが存在し、連続性が存在するかが判断軸
  - ライフサイクルが存在するならば「エンティティ」、しないなら「値オブジェクト」と基本的に判断できる

- コレクションオブジェクト
  - Array, Set, Mapなどをインスタンス変数として持ち、そのインスタンス変数の操作ロジックを集めたオブジェクトのこと
  - 1:nの関係などを表現する際に必要になる設計パターン

- 区分オブジェクト
  - 場合分けと組み合わせが生まれたときに使う区分を表現するオブジェクトのこと
  - JavaならEnumを使えば表現可能

- モジュール
  - DDDをすすめるうえで出てきたいろんなクラスを関連のある1つの単位でまとめたもの
  - パッケージ、名前空間とほぼ同じ意味

- 集約
  - 業務ルールを表現しようとしたときに複数のエンティティや値オブジェクトを使うことがあり、それらをまとめたオブジェクトのことを集約オブジェクトという

- ユビキタス言語
  - 関係者全員がいつでもどこでも同じ言葉を使うという目標を表現した言葉のことをユビキタス言語という

- 境界づけられたコンテキスト
  - ユビキタス言語として一致する範囲のことをいう
  - 同じユビキタス言語を使用して会話できるうちは同じコンテキストとして認識できる

- ドメイン
  - 事業活動や業務のソフトウェアが対象とする「領域」のことを指す
　- ソフトウェアで解決する問題の範囲とも言える

- ドメインサービス
  - 値オブジェクトやエンティティに記述すると不自然になってしまうふるまいを代わりに実行してくれるオブジェクト
  - 自身の振る舞いを変更するようなインスタンス特有の状態を持たないオブジェクト
  - 使い所は「不自然な振る舞い」に限定することが重要
  - エンティティ、値オブジェクトに書くべきか、ドメインサービスに書くべきか、迷うくらいならまずはドメインサービスをつかわずに書いてみる方針に倒すほうが良いらしい。なんなら可能であれば使わないほうが好ましいもの

- リポジトリ
  - 集約の永続化(保存)と再構築(復元)をアプリケーションサービスから分離するためのオブジェクト
  - 永続化
    - インスタンスを保存し、復元できるようにすること
  - 再構築
    - インスタンスを取得できること

- アプリケーショサービス（ ユースケース層と呼ばれることも）
  - ユースケースを実現するオブジェクト
  - 業務を実現するうえで、ドメインオブジェクトを操作して目的を達成させるためのクラスになる
  - ユースケース = 商品を注文するなど

- CQS/CQRS（似ているため、違いを重点的に調べてみましょう）
  - CQS
    - オブジェクトのメソッドレベルでの Command と Query を明確に分けようという考え
    - 1つのメソッドが行えるのは、Command か Queryのいずれかであるというもので、どちらも兼ねたメソッドがいてはいけないという考え方
    - 具体的には、更新して結果を返すみたいな、`updateAndReturnId`みたいなメソッドを作らないというもの
  - CQRS
    - CQSの考え方をソフトウェアのアーキテクチャレベルに適用したもの
    - Command と Query を行うときのAPIもデータソースも分けているという考え方になる
    - データ自体は結果整合性になる
  - メモ
    - このパターンを適用できる場合は、スケールしやすいアプリケーションにすることができる
    - CommandもQueryも同じ場合はデータベースでのロックまちなどが要因でQueryに影響することがありうる
    - データソースもAPIも別になっているのであれば、Commandによる影響をQuery側に与えなくて済む
    - とはいえ、↑だけが理由ならばCQRSを適用しなくても↑の課題を解決する手法はあるので、複雑さとのトレードオフになりそう
    - イベントの記録が漏らさないを優先するなら、複雑度があがったとしても適用するメリットは大きそうに見える

- イベントソーシング
  - アプリケーションの状態の変化をすべてイベントとして表現する設計手法
  - あらゆる状態の変化をイベントとして捉えることで記録漏れなどが生まれない構造になる
  - CQRSやマイクロサービスなどで使われることが多い

- ステートソーシング
  - アプリケーションの状態を中心に考える設計手法
  - よくあるCRUD中心のアプリケーションで使われる

- DTO
  - Data Transfer Objectの略。システム / アプリケーション内のレイヤーをまたぐ際にデータを受け渡しのためだけに使うオブジェクトのこと

- ドメインモデル貧血症
  - ドメイン層っぽいデータを持つクラスをつくってはいるものの、フィールドのgetter/setterだけを返すメソッドを持つもののこと
  - 貧血症状態のモデルは不変条件を満たしておらずで業務ロジックも持っていないオブジェクトになる

- ドメインイベント
  - 一連の業務活動で発生した出来事を特定し表現する手法
  - 業務ルールによって生まれた結果がドメインイベントになる

- サービス
  - クライアントのために何かをおこなうもの
  - 自身のふるまいを持たないため、活動や行動を示すことが多い

- Always Valid Domain Model
  - ドメインオブジェクトは、Validな状態でしか生成・存在できないようにしよう
  - 不正なオブジェクトがつくれうる状態だと、呼び出し側がそのチェックを意識しないといけなくなるため
  - それなら、そもそも不正なオブジェクトなんて作らせないようにしておこうというのがベースの考え方

### 参考
- [[DDD]モデルでドメイン知識を表現するとは何か](https://qiita.com/little_hand_s/items/69ccbb9915d75ad09ad5)
- [Always-Valid Domain Model](https://scrapbox.io/kawasima/Always-Valid_Domain_Model)
 - [ドメインモデル貧血症](https://scrapbox.io/kawasima/%E3%83%89%E3%83%A1%E3%82%A4%E3%83%B3%E3%83%A2%E3%83%87%E3%83%AB%E8%B2%A7%E8%A1%80%E7%97%87)
- [入門 ドメイン駆動設計](https://www.amazon.co.jp/%EF%BC%BB%E5%85%A5%E9%96%80%EF%BC%BD%E3%83%89%E3%83%A1%E3%82%A4%E3%83%B3%E9%A7%86%E5%8B%95%E8%A8%AD%E8%A8%88%E2%80%95%E2%80%95%E5%9F%BA%E7%A4%8E%E3%81%A8%E5%AE%9F%E8%B7%B5%E3%83%BB%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%A2%E3%83%BC%E3%82%AD%E3%83%86%E3%82%AF%E3%83%81%E3%83%A3-Software-Design%E5%88%A5%E5%86%8A-%E5%A2%97%E7%94%B0-%E4%BA%A8/dp/4297143178/ref=sr_1_3_sspa?adgrpid=85923442780&dib=eyJ2IjoiMSJ9.dQZNgmi1PxWGA58xomliOWUshcr92ahAGLi5cWSt6eselIaa5-FCHCYkyuQ4BQdXMx1gN8bQKbS4RBVOUC8FwDoSZxUU21K-wm-UusSb5TQdZ-PwCbVZe2D_wNMvCo9HbDrHBu221_SUt8j-oNFXb9OmCAiCa-OTLkyqg0B6s-iTE0OAC8YYpy3u0ck7MaXEq8IdpQojh0x7BU2JhuYkAGgG1Wc9PJsW7_t3BbFL0aj5_LiJ0dz4Hcn1XjZ2E_09L_XoH7LMfYyOdu_xpNQYdAlesI44tBzJWyDkQb05ITE.gGQeNHUDLVyHK1VP6Mqqx4FA1o2BfVN5Ot-G1oq4BtM&dib_tag=se&hvadid=678998177968&hvdev=c&hvlocphy=9198923&hvnetw=g&hvqmt=e&hvrand=18389894475147829002&hvtargid=kwd-879790297571&hydadcr=1790_13657015&jp-ad-ap=0&keywords=%E3%83%89%E3%83%A1%E3%82%A4%E3%83%B3%E9%A7%86%E5%8B%95%E8%A8%AD%E8%A8%88+%E5%85%A5%E9%96%80&mcid=2dece892027a3c9fbb571dab6b7faabe&qid=1748077158&sr=8-3-spons&sp_csd=d2lkZ2V0TmFtZT1zcF9hdGY&psc=1)
- [CQRSとCQSの違い](https://zenn.dev/praha/articles/4da7c1f91fb91f)
- [CQS](https://ja.wikipedia.org/wiki/%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%82%AF%E3%82%A8%E3%83%AA%E5%88%86%E9%9B%A2)
- [コマンドクエリ責任分離](https://ja.wikipedia.org/wiki/%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%82%AF%E3%82%A8%E3%83%AA%E8%B2%AC%E4%BB%BB%E5%88%86%E9%9B%A2)
- [CQRSパターン AWS](https://docs.aws.amazon.com/ja_jp/prescriptive-guidance/latest/modernization-data-persistence/cqrs-pattern.html)
- [CQRSパターン Microsoft](https://learn.microsoft.com/ja-jp/azure/architecture/patterns/cqrs)
- [Event Sourcing 完全に理解した](https://zenn.dev/shmi593/articles/56c890962bb807)
- [イベントソーシングパターン AWS](https://docs.aws.amazon.com/ja_jp/prescriptive-guidance/latest/cloud-design-patterns/event-sourcing.html)
- [イベント ソーシング パターン Microsoft](https://docs.aws.amazon.com/ja_jp/prescriptive-guidance/latest/cloud-design-patterns/event-sourcing.htmlhttps://docs.aws.amazon.com/ja_jp/prescriptive-guidance/latest/cloud-design-patterns/event-sourcing.htmlhttps://docs.aws.amazon.com/ja_jp/prescriptive-guidance/latest/cloud-design-patterns/event-sourcing.html)
