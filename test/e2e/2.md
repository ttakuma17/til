## 課題2-1

E2Eテストのメリットとデメリットを挙げてください

- メリット
  - 実際にユーザーが操作するようなシナリオをテストできること
  - UIの操作を通して、フロントエンド〜バックエンド、データベースなどの複数の要素をまとめてテストできること
  - 本番環境に近い状態でテストできる
  - 手動テストを毎回行っている場合は自動化することで手間は削減できる。仕様を早く理解するということにもつながる
- デメリット
  - メンテナンスコストが高い。
    - UIを変えるたびにテストを書き換えないといけない
  - 単純なケースでも、テスト実行の時間がそれなりに掛かること
    - CI時間かかる
    - テストの書き方によるかもしれないが、Flakyなテストが生まれると時間だけが増えることもある
  - 本番環境とテスト環境の差分により、本番では発生しない不具合がテスト環境で起きるケースもあり得る
    - これによって無駄な対応工数がかかることやテスト自体の信頼性が揺らぐことになる

## 課題2-2

E2Eでしかテストできない機能（jestを使った単純な関数のテスト・Storybookを使ったコンポーネントのテスト・スクリーンショットの比較によるビジュアルリグレッションテストではテストできない機能）とは、どのような機能でしょうか？思いつく限り例を挙げてみてください

- E2Eテストでないとテストできない機能の例
  - フロントエンドとバックエンド含めた動作のテスト
    - フォームの内容を全部登録した場合、一部登録した場合などの登録による振る舞いの違いを確認したいケース（フォームの入力値で複数エラーがあった場合に全てをエラーを表示するのか、優先して1つだけエラーを表示させるなど）
    - 会員登録でフォームを通して、登録した結果、適切にデータが登録されて、フロントへ表示されているか
  - アニメーションなどが期待どおり動いているか

## 課題2-3

アプリケーションのすべての機能に対して、

- jestを使った単純な関数のテスト
- Storybookを使ったコンポーネントのテスト
- ビジュアルリグレッションテスト
- E2Eテスト

を網羅的に書くことはコストや保守性の面から現実的ではありません。どういった基準を設けて優先順位を決めるべきでしょうか？

- Testing TrophyやGoogleのTest Sizeなどに基づいて、優先順位を決めたい
  - 基本的には、テスト実行のコストが少ないものは多めにかき、テスト実行のコストが大きいものはビジネス的に重要なところだけに絞るなどの基準にしたい
  - 「jestを使った単純な関数のテスト」はこのなかではもっともコストが低いので、単体テストレベルで期待通り動作するのかの検証はしたいので、テストケース数は最も多くしたい
  - Storybookを使ったコンポーネントのテストは色々なところで、共通で使うようなコンポーネントは必ずテストしておきたいが、独立したコンポーネントであれば、ページレベルでビジュアルリグレッションテストでカバーできるケースもあると考えられる。テストのコストを踏まえてどちらでカバーするかを決めたい
  - ビジュアルリグレッションテスト、E2Eテストは、本当にビジネス的に重要な導線だけに絞って実行したい

参考
- https://kentcdodds.com/blog/the-testing-trophy-and-testing-classifications
- https://testing.googleblog.com/2010/12/test-sizes.html