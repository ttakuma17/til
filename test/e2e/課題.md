### 課題1-1

Playwrightを使って、E2Eテストを実行できる環境を整えてください。

- https://github.com/ttakuma17/til/blob/main/test/e2e/playwright

### 課題1-2

自動テスト練習用のサイトを使ってPlaywrightによる自動テストを実装してみましょう

Playwrightから、次のサイトにアクセスしてみてください
https://hotel.testplanisphere.dev/ja/

- https://github.com/ttakuma17/til/blob/main/test/e2e/playwright/tests/hotel.spec.js

### 課題1-3

会員登録ページに移動してみてください

- https://github.com/ttakuma17/til/blob/main/test/e2e/playwright/tests/hotel.spec.js

### 課題1-4

会員登録に必要な情報をフォームに入力し、会員登録をしてみてください

- https://github.com/ttakuma17/til/blob/main/test/e2e/playwright/tests/hotel.spec.js

### 課題1-5

マイページに移動し、入力した内容が反映されていることを確認してみてください

`@playwright/test`から`expect`をimportし、氏名などが入力内容と一致していることをテストしてください

- https://github.com/ttakuma17/til/blob/main/test/e2e/playwright/tests/hotel.spec.js

### 課題1-6

宿泊予約ページに移動し、フォームの入力→予約内容の確認→予約完了まで実行してみてください

予約内容確認ページで、入力した内容が反映されているかを`expect`でテストしてください

- https://github.com/ttakuma17/til/blob/main/test/e2e/playwright/tests/hotel.reserve.spec.js

### 課題2-1

E2Eテストのメリットとデメリットを挙げてください

- メリット
  - 実際にユーザーが操作するようなシナリオをテストできること
  - UIの操作を通して、フロントエンド〜バックエンド、データベースなどの複数の要素をまとめてテストできること
  - 本番環境に近い状態でテストできる
  - 手動テストを毎回行っている場合は自動化することで手間は削減できる。仕様を早く理解するということにもつながる
- デメリット
  - メンテナンスコストが高い。
    - UIを変えるたびにテストを書き換えないといけない
  - 単純なケースでも、テスト実行の時間がそれなりに掛かること
    - CI時間かかる
    - テストの書き方によるかもしれないが、Flakyなテストが生まれると時間だけが増えることもある
  - 本番環境とテスト環境の差分により、本番では発生しない不具合がテスト環境で起きるケースもあり得る
    - これによって無駄な対応工数がかかることやテスト自体の信頼性が揺らぐことになる

### 課題2-2

E2Eでしかテストできない機能（jestを使った単純な関数のテスト・Storybookを使ったコンポーネントのテスト・スクリーンショットの比較によるビジュアルリグレッションテストではテストできない機能）とは、どのような機能でしょうか？思いつく限り例を挙げてみてください

- E2Eテストでないとテストできない機能の例
  - フロントエンドとバックエンド含めた動作のテスト
    - フォームの内容を全部登録した場合、一部登録した場合などの登録による振る舞いの違いを確認したいケース（フォームの入力値で複数エラーがあった場合に全てをエラーを表示するのか、優先して1つだけエラーを表示させるなど）
    - 会員登録でフォームを通して、登録した結果、適切にデータが登録されて、フロントへ表示されているか
  - アニメーションなどが期待どおり動いているか

## 課題2-3

アプリケーションのすべての機能に対して、

- jestを使った単純な関数のテスト
- Storybookを使ったコンポーネントのテスト
- ビジュアルリグレッションテスト
- E2Eテスト

を網羅的に書くことはコストや保守性の面から現実的ではありません。どういった基準を設けて優先順位を決めるべきでしょうか？

- Testing TrophyやGoogleのTest Sizeなどに基づいて、優先順位を決めたい
  - 基本的には、テスト実行のコストが少ないものは多めにかき、テスト実行のコストが大きいものはビジネス的に重要なところだけに絞るなどの基準にしたい
  - 「jestを使った単純な関数のテスト」はこのなかではもっともコストが低いので、単体テストレベルで期待通り動作するのかの検証はしたいので、テストケース数は最も多くしたい
  - Storybookを使ったコンポーネントのテストは色々なところで、共通で使うようなコンポーネントは必ずテストしておきたいが、独立したコンポーネントであれば、ページレベルでビジュアルリグレッションテストでカバーできるケースもあると考えられる。テストのコストを踏まえてどちらでカバーするかを決めたい
  - ビジュアルリグレッションテスト、E2Eテストは、本当にビジネス的に重要な導線だけに絞って実行したい

参考
- https://kentcdodds.com/blog/the-testing-trophy-and-testing-classifications
- https://testing.googleblog.com/2010/12/test-sizes.html

### 課題3

E2Eテストに関するクイズ
- E2Eテストを行う範囲はどのように決めますか？例えば、Amazonを例にした場合、どこにE2Eテスト実行したいか、なぜその導線を選んだかを説明してください
- E2Eテストはどれくらいの頻度で実行するのが適切でしょうか？頻度と理由を考えて説明してください
- E2Eテストを増やした結果、実行時間が3時間かかるようになりました。PR作成時のCIで毎回実行され、そのテストが通るまでマージできない場合、どのような対応を取りますか？チームで議論してください

